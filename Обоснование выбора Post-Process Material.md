# **Обоснование выбора Post-Process Material как основного метода реализации**

В процессе разработки модуля визуального анализа возникла необходимость выбора архитектурного решения. Рассматривались два основных подхода: создание специализированного шейдера для каждого объекта (Master Material Overlay) и использование пост-процесс материала (Post-Process Material). В данной главе обосновывается выбор последнего как наиболее эффективного и масштабируемого метода.

## **1\. Доступ к данным через G-Buffer**

Основным преимуществом Post-Process материала в Unreal Engine является прямой доступ к **G-Buffer** (Geometry Buffer). В отложенном рендеринге (Deferred Rendering), который используется в UE по умолчанию, движок сначала записывает все свойства материалов (Base Color, Metallic, Roughness, Specular, Normal) в отдельные экранные буферы, и только потом производит расчет освещения.

**Преимущества работы с G-Buffer:**

* Мы анализируем не исходную текстуру на диске, а конечное значение, которое попадает в расчеты освещения. Это учитывает влияние всех модификаторов внутри Master-материалов, функций смешивания (Material Functions) и слоев (Material Layers).  
* Метод работает для всех объектов в сцене одновременно. Нет необходимости изменять или перенастраивать материалы каждого отдельного ассета.  
* Пост-процесс учитывает влияние декалей и динамических изменений материала в реальном времени, что невозможно при анализе просто исходного ассета.

## **2\. Изоляция логики от производственного конвейера**

Использование Post-Process материала позволяет реализовать систему анализа как “диагностический слой”, наложенный поверх кадра.

1. Нам не нужно внедрять проверочный код в основные шейдеры проекта. Это исключает риск случайного повреждения рабочих материалов художников или изменения их логики.  
2. Анализатор включается только тогда, когда это необходимо тех-артисту. В финальной сборке (Shipping build) пост-процесс просто отключается, не оставляя лишних инструкций в материалах объектов.  
3. Post-Process позволяет легко переключаться между различными режимами визуализации (например, режим «только Albedo Check» или «Lighting (EV) Check»).

## **3\. Анализ в контексте Substrate**

С внедрением системы **Substrate** в Unreal Engine 5, структура данных материалов стала значительно сложнее. Классический подход “открой текстуру и посмотри яркость” перестал работать, так как финальный пиксель может быть результатом смешивания нескольких слоев (Slabs).

Post-Process материал в данном случае является единственным надежным способом получить **агрегированные данные** о поверхности материала после того, как Substrate завершил свои сложные вычисления по объединению слоев. Мы получаем уже распакованные физические параметры, готовые к валидации.

## **4\. Вывод**

Выбор **Post-Process Material** обусловлен необходимостью создания универсального, высокопроизводительного и точного инструмента, который работает с финальными данными в графическом конвейере. Этот метод позволяет анализировать сцену целиком, учитывая сложные взаимодействия слоев материалов (особенно в Substrate) и влияние динамических эффектов, что делает его оптимальным решением для задач контроля качества (QA) и технического арта в современных игровых проектах на базе Unreal Engine 5\.
